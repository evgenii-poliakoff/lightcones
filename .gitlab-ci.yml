stages:
  - setup
  - build
  - test

setup:
  stage: setup
  script:
    - echo "Enter setup stage..."
    - ./scripts/install_requirements.sh
  tags:
    #- ar
    - alba

build:
  stage: build
  script: 
    - echo "Enter build state..."
    - source ~/.bashrc
    - conda activate base
    #- source ./venv/bin/activate
    - ./build.sh
  artifacts:
    paths:
      - '**/*.so'
  tags:
    #- ar
    - alba
  
test:
  stage: test
  script:
    - echo "Enter test stage..."
    - source ~/.bashrc
    - conda activate base
    #- pip install pytest
    #- pip install pytest-pythonpath
    #- source ./venv/bin/activate
    - python3 -m pytest ./tests
  dependencies:
    - build
  tags:
    #- ar
    - alba